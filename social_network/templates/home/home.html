{% extends 'base.html' %}
{% load static %}

{% block title %}
<title>Main</title>
<link rel="icon" href="{% static 'icons/Bin.jpg' %}" type="image/png">
<link rel="stylesheet" href="{% static 'css/home.css' %}">
<link rel="stylesheet" href="{% static 'js/home.js' %}">

<style>
.username {
    text-align: left;
    margin: 5px 0;
    font-weight: bold;
}

.username-line {
    align-self: flex-start;
    text-align: left;
    margin: 5px 0;
    font-weight: bold;
}

body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
}

#menu-toggle,
#profile-toggle,
#setting-toggle,
#form1-toggle,
#form2-toggle,
#wallet-toggle,
#check-subscription-toggle,
#subscribe-month-toggle,
#subscribe-year-toggle,
#bin_mouth-toggle,
#bin_premium_mouth-toggle,
#bin_years-toggle,
#bin_premium_years-toggle,
#deposit-toggle,
#add_card-toggle {
    display: none;
}

/* –ì–∞–º–±—É—Ä–≥–µ—Ä */
.hamburger {
    position: fixed;
    top: 20px;
    left: 20px;
    width: 30px;
    height: 25px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
    z-index: 1001;
}

.hamburger span {
    display: block;
    height: 4px;
    background: #333;
    border-radius: 2px;
    transition: 0.3s;
}

#menu-toggle:checked + .hamburger span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
}

#menu-toggle:checked + .hamburger span:nth-child(2) {
    opacity: 0;
}

#menu-toggle:checked + .hamburger span:nth-child(3) {
    transform: rotate(-45deg) translate(5px, -5px);
}

/* –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é */
.side-menu {
    position: fixed;
    top: 0;
    left: -300px;
    width: 300px;
    height: 100%;
    background: #fff;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
    padding: 20px;
    box-sizing: border-box;
    transition: 0.3s;
    z-index: 1002;
}

#menu-toggle:checked ~ .side-menu {
    left: 0;
}

.overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    z-index: 1000;
}

#menu-toggle:checked ~ .overlay {
    display: block;
}

.content {
    padding: 50px;
}

.side-menu .avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 15px;
}

.side-menu .username-line {
    border-bottom: 1px solid #ccc;
    padding-bottom: 5px;
    margin-bottom: 10px;
}

.side-menu .profile-btn,
.side-menu .setting-btn {
    display: block;
    background: white;
    color: #333;
    text-align: center;
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    text-decoration: none;
    margin-top: 5px;
    border: 1px solid #ccc;
    transition: 0.2s;
}

.side-menu .profile-btn:hover,
.side-menu .setting-btn:hover {
    background: #e0e0e0;
}

/* –§–æ—Ä–º—ã */
.profile-form,
.setting-form,
.form1,
.form2 {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 400px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.profile-form .info {
    display: flex;
    flex-direction: column;
    min-width: 0;
    max-width: 100%;
}

.profile-form .info h2 {
    font-size: 1.4rem;
    margin: 0;
    word-wrap: break-word;
    overflow-wrap: anywhere; 
    white-space: normal;
    text-align: left;
}


.form1 img.avatar,
.form2 img.avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    margin-bottom: 10px;
}

#profile-toggle:checked ~ .profile-form {
    display: flex;
}

#setting-toggle:checked ~ .setting-form {
    display: flex;
}

#form1-toggle:checked ~ .form1 {
    display: flex;
}

#form2-toggle:checked ~ .form2 {
    display: flex;
}

/* –û–≤–µ—Ä–ª–µ–∏ */
.profile-overlay,
.setting-overlay,
.form1-overlay,
.form2-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    z-index: 1500;
}

#profile-toggle:checked ~ .profile-overlay {
    display: block;
}

#setting-toggle:checked ~ .setting-overlay {
    display: block;
}

#form1-toggle:checked ~ .form1-overlay {
    display: block;
}

#form2-toggle:checked ~ .form2-overlay {
    display: block;
}

/* –ö–Ω–æ–ø–∫–∏ —Ñ–æ—Ä–º */
.profile-form button,
.setting-form button,
.form1 button,
.form2 button,
.setting-form .profile-btn {
    background: white;
    border: 1px solid #ccc;
    color: #333;
    padding: 10px;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.2s;
}

.profile-form button:hover,
.setting-form button:hover,
.form1 button:hover,
.form2 button:hover,
.setting-form .profile-btn:hover {
    background: #e0e0e0;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è */
.profile-header {
    display: flex;
    align-items: center;
    gap: 25px;
}

.profile-header img.avatar {
    width: 130px;
    height: 130px;
    border-radius: 50%;
    object-fit: cover;
}

.profile-header .info {
    display: flex;
    flex-direction: column;
}

.profile-header .info h2 {
    margin: 0;
    font-size: 26px;
    color: #333;
}

.profile-header .info p {
    margin: 5px 0 0 0;
    color: #777;
    font-size: 15px;
}

.profile-divider {
    border: none;
    border-top: 1px solid #ddd;
    margin: 25px 0 15px 0;
}

.profile-body p {
    margin: 10px 0;
    color: #444;
    font-size: 15px;
}

.tag-copy {
    font-weight: bold;
    color: #007bff;
    cursor: pointer;
    margin-left: 5px;
}

.profile-body textarea {
    resize: none;
    font-family: Arial, sans-serif;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    width: 100%;
}

.language-form {
  margin: 10px 0 20px 0;
}

.language-form select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

/* –ö–æ—à–µ–ª—ë–∫ */
.wallet button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.wallet button:hover {
  background: #008080cc;
}

.wallet {
  margin: 10px 0 20px 0;
}

.wallet select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.wallet button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.wallet button:hover {
  background: #008080cc;
}

.wallet {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.wallet-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.wallet-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 300px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.wallet.active {
    display: flex;
}
.wallet-overlay.active {
    display: block;
}

#wallet-toggle:checked ~ .wallet-form,
#wallet-toggle:checked ~ .wallet {
    display: flex;
}
#wallet-toggle:checked ~ .wallet-overlay {
    display: block;
}


/* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã */
.add_card button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.add_card button:hover {
  background: #008080cc;
}

.add_card {
  margin: 10px 0 20px 0;
}

.add_card select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.add_card button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.add_card button:hover {
  background: #008080cc;
}

.add_card {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.add_card-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.add_card-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 300px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.add_card.active {
    display: flex;
}
.add_card-overlay.active {
    display: block;
}

#add_card-toggle:checked ~ .add_card-form,
#add_card-toggle:checked ~ .add_card {
    display: flex;
}
#add_card-toggle:checked ~ .add_card-overlay {
    display: block;
}
/* –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ */
.deposit button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.deposit button:hover {
  background: #008080cc;
}

.deposit {
  margin: 10px 0 20px 0;
}

.deposit select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.deposit button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.deposit button:hover {
  background: #008080cc;
}

.deposit {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.deposit-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.deposit-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 300px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.deposit-btn {
    padding: 10px 20px;
    border-radius: 8px;
    border: 2px solid #007bff;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
}

.deposit-btn:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

.deposit.active {
    display: flex;
}
.deposit-overlay.active {
    display: block;
}

#deposit-toggle:checked ~ .deposit-form,
#deposit-toggle:checked ~ .deposit {
    display: flex;
}
#deposit-toggle:checked ~ .deposit-overlay {
    display: block;
}

/* –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
.check-subscription button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.check-subscription button:hover {
  background: #008080cc;
}

.check-subscription {
  margin: 10px 0 20px 0;
}

.check-subscription select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.check-subscription button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.check-subscription button:hover {
  background: #008080cc;
}

.check-subscription {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.check-subscription-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.check-subscription-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 300px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.check-subscription-btn {
    padding: 10px 20px;
    border-radius: 8px;
    border: 2px solid #007bff;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
}

.check-subscription-btn:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

.check-subscription.active {
    display: flex;
}
.check-subscription-overlay.active {
    display: block;
}

#check-subscription-toggle:checked ~ .check-subscription-form,
#check-subscription-toggle:checked ~ .check-subscription {
    display: flex;
}
#check-subscription-toggle:checked ~ .check-subscription-overlay {
    display: block;
}

/* –∫–Ω–æ–ø–∫–∏ –≤ –ø–æ–¥–ø–∏—Å–∫–µ */
.subscribe-btn {
    padding: 10px 20px;
    border-radius: 8px;
    border: 2px solid #007bff;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
}

.subscribe-btn:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}


/* –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –º—ñ—Å—è—Ü—å */
.subscribe-form-month button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.subscribe-form-month button:hover {
  background: #008080cc;
}

.subscribe-form-month {
  margin: 10px 0 20px 0;
}

.subscribe-form-month select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.subscribe-form-month button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.subscribe-form-month button:hover {
  background: #008080cc;
}

.subscribe-form-month {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.subscribe-month-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.subscribe-form-month.active {
    display: flex;
}
.subscribe-month-overlay.active {
    display: block;
}

#subscribe-month-toggle:checked ~ .subscribe-form-month {
    display: flex;
}

#subscribe-month-toggle:checked ~ .subscribe-month-overlay {
    display: block;
}


/* –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä—ñ–∫ */
.subscribe-form-year button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.subscribe-form-year button:hover {
  background: #008080cc;
}

.subscribe-form-year {
  margin: 10px 0 20px 0;
}

.subscribe-form-year select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.subscribe-form-year button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.subscribe-form-year button:hover {
  background: #008080cc;
}

.subscribe-form-year {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.subscribe-year-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.subscribe-form-year.active {
    display: flex;
}
.subscribe-year-overlay.active {
    display: block;
}

#subscribe-year-toggle:checked ~ .subscribe-form-year {
    display: flex;
}

#subscribe-year-toggle:checked ~ .subscribe-year-overlay {
    display: block;
}


/* –∫–Ω–æ–ø–∫–∏ –≤ –ø–æ–¥–ø–∏—Å–∫–µ */
.subscribe-btn {
    position: relative;
    padding: 10px 20px;
    border-radius: 8px;
    border: 2px solid #007bff;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: 0.2s;
}

.subscribe-btn:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

.year-btn .discount {
    position: absolute;
    top: -11px;  
    right: -10px;
    background-color: red;
    color: white;
    font-size: 12px;
    font-weight: 600;
    padding: 2px 5px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

/* Bin+ mouth */
.bin_mouth button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_mouth button:hover {
  background: #008080cc;
}

.bin_mouth {
  margin: 10px 0 20px 0;
}

.bin_mouth select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.bin_mouth button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_mouth button:hover {
  background: #008080cc;
}

.bin_mouth {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.bin_mouth-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.bin_mouth-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 350px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.bin_mouth.active {
    display: flex;
}
.bin_mouth-overlay.active {
    display: block;
}

#bin_mouth-toggle:checked ~ .bin_mouth-form,
#bin_mouth-toggle:checked ~ .bin_mouth {
    display: flex;
}
#bin_mouth-toggle:checked ~ .bin_mouth-overlay {
    display: block;
}


/* bin premium mouth */
.bin_premium_mouth button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_premium_mouth button:hover {
  background: #008080cc;
}

.bin_premium_mouth {
  margin: 10px 0 20px 0;
}

.bin_premium_mouth select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.bin_premium_mouth button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_premium_mouth button:hover {
  background: #008080cc;
}

.bin_premium_mouth {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.bin_premium_mouth-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.bin_premium_mouth-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 450px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.bin_premium_mouth.active {
    display: flex;
}
.bin_premium_mouth-overlay.active {
    display: block;
}

#bin_premium_mouth-toggle:checked ~ .bin_premium_mouth-form,
#bin_premium_mouth-toggle:checked ~ .bin_premium_mouth {
    display: flex;
}
#bin_premium_mouth-toggle:checked ~ .bin_premium_mouth-overlay {
    display: block;
}



/* Bin+ years */
.bin_years button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_years button:hover {
  background: #008080cc;
}

.bin_years {
  margin: 10px 0 20px 0;
}

.bin_years select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.bin_years button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_years button:hover {
  background: #008080cc;
}

.bin_years {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.bin_years-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.bin_years-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 430px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.bin_years.active {
    display: flex;
}
.bin_years-overlay.active {
    display: block;
}

#bin_years-toggle:checked ~ .bin_years-form,
#bin_years-toggle:checked ~ .bin_years {
    display: flex;
}
#bin_years-toggle:checked ~ .bin_years-overlay {
    display: block;
}


/* bin premium years */
.bin_premium_years button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_premium_years button:hover {
  background: #008080cc;
}

.bin_premium_years {
  margin: 10px 0 20px 0;
}

.bin_premium_years select {
  padding: 8px 12px;
  font-size: 14px;
  border-radius: 8px;
  border: 1px solid #aaa;
  cursor: pointer;
}

.bin_premium_years button {
  padding: 8px 12px;
  margin-left: 8px;
  border-radius: 8px;
  border: 1px solid #aaa;
  background: teal;
  color: #fff;
  cursor: pointer;
  transition: 0.2s;
}

.bin_premium_years button:hover {
  background: #008080cc;
}

.bin_premium_years {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    z-index: 2000;
    width: 700px;
    max-width: 90%;
    min-height: 400px;
    flex-direction: column;
    gap: 20px;
}

.bin_premium_years-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.3);
    z-index: 1500;
}

.bin_premium_years-form {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
    display: none;
    z-index: 2000;
    width: 520px;
    max-width: 90%;
    box-sizing: border-box;
    flex-direction: column;
    gap: 20px;
}

.bin_premium_years.active {
    display: flex;
}
.bin_premium_years-overlay.active {
    display: block;
}

#bin_premium_years-toggle:checked ~ .bin_premium_years-form,
#bin_premium_years-toggle:checked ~ .bin_premium_years {
    display: flex;
}
#bin_premium_years-toggle:checked ~ .bin_premium_years-overlay {
    display: block;
}

/* –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
.Subscribe-switching-button {
    margin-top: 15px;
    padding: 10px 25px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    background-color: #007bff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s ease;
    position: relative; /* —á—Ç–æ–±—ã –≤–Ω—É—Ç—Ä–∏ –∫–Ω–æ–ø–∫–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å span */
}

.Subscribe-switching-button:hover:enabled {
    background-color: #0056b3;
    transform: scale(1.05);
}

.Subscribe-switching-button:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}

/* –°—Ç–∏–ª—å –¥–ª—è —Å–∫–∏–¥–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∫–Ω–æ–ø–∫–∏ */
.Subscribe-switching-button .discount {
    position: absolute;
    top: -9px;
    right: -18px;
    background-color: red;
    color: white;
    font-size: 12px;
    padding: 2px 5px;
    border-radius: 4px;
}

/* –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
.subscribe-btn {
    margin-top: 15px;
    padding: 10px 25px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    background-color: #007bff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s ease;
    
    /* –ù–æ–≤—ã–π —Å—Ç–∏–ª—å –¥–ª—è —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è */
    width: 100%;
    box-sizing: border-box; /* —á—Ç–æ–±—ã padding –Ω–µ –≤—ã–ª–∞–∑–∏–ª –∑–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
}

.subscribe-btn:hover:enabled {
    background-color: #0056b3;
    transform: scale(1.05);
}

.subscribe-btn:disabled {
    background-color: #cccccc;
    cursor: not-allowed;
}

/* –∑–∞—á—ë—Ä–∫–Ω—É—Ç–∞—è —Ü–µ–Ω–∞ */
.pricing {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-size: 1.2rem;
}

.old-price {
    color: #999;
    text-decoration: line-through;
    font-size: 1rem;
}

.new-price {
    color: #ff0000;
    font-weight: bold;
    font-size: 1.3rem;
}


/* –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏ */
.check-subscription-btn {
    padding: 12px 25px;
    font-size: 16px;
    font-weight: bold;
    border-radius: 8px;
    border: none;
    background-color: #1900ff;
    color: white;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.1s ease;
}

.check-subscription-btn:hover {
    background-color: #1200b1;
    transform: scale(1.05);
}


/* From Uiverse.io by Yaya12085 */ 
.plan {
  border-radius: 16px;
  box-shadow: 0 30px 30px -25px rgba(0, 38, 255, 0.205);
  padding: 10px;
  background-color: #fff;
  color: #697e91;
  max-width: 300px;
}

.plan strong {
  font-weight: 600;
  color: #425275;
}

.plan .inner {
  align-items: center;
  padding: 20px;
  padding-top: 40px;
  background-color: #ecf0ff;
  border-radius: 12px;
  position: relative;
}

.plan .pricing {
  position: absolute;
  top: 0;
  right: 0;
  background-color: #bed6fb;
  border-radius: 99em 0 0 99em;
  display: flex;
  align-items: center;
  padding: 0.625em 0.75em;
  font-size: 1.25rem;
  font-weight: 600;
  color: #425475;
}

.plan .pricing small {
  color: #707a91;
  font-size: 0.75em;
  margin-left: 0.25em;
}

.plan .title {
  font-weight: 600;
  font-size: 1.25rem;
  color: #425675;
}

.plan .title + * {
  margin-top: 0.75rem;
}

.plan .info + * {
  margin-top: 1rem;
}

.plan .features {
  display: flex;
  flex-direction: column;
}

.plan .features li {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.plan .features li + * {
  margin-top: 0.75rem;
}

.plan .features .icon {
  background-color: #1FCAC5;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
}

.plan .features .icon svg {
  width: 14px;
  height: 14px;
}

.plan .features + * {
  margin-top: 1.25rem;
}

.plan .action {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: end;
}

.plan .button {
  background-color: #6558d3;
  border-radius: 6px;
  color: #fff;
  font-weight: 500;
  font-size: 1.125rem;
  text-align: center;
  border: 0;
  outline: 0;
  width: 100%;
  padding: 0.625em 0.75em;
  text-decoration: none;
}

.plan .button:hover, .plan .button:focus {
  background-color: #4133B7;
}
</style>
{% endblock %}

{% block body %}
<input type="checkbox" id="menu-toggle">
<input type="checkbox" id="profile-toggle">
<input type="checkbox" id="setting-toggle">
<input type="checkbox" id="form1-toggle">
<input type="checkbox" id="form2-toggle">
<input type="checkbox" id="wallet-toggle">
<input type="checkbox" id="check-subscription-toggle">
<input type="checkbox" id="subscribe-month-toggle">
<input type="checkbox" id="subscribe-year-toggle">
<input type="checkbox" id="deposit-toggle">
<input type="checkbox" id="add_card-toggle">
<input type="checkbox" id="bin_mouth-toggle">
<input type="checkbox" id="bin_premium_mouth-toggle">
<input type="checkbox" id="bin_years-toggle">
<input type="checkbox" id="bin_premium_years-toggle">

<div class="profile-overlay"></div>
<div class="setting-overlay"></div>
<div class="form1-overlay"></div>
<div class="form2-overlay"></div>
<div class="wallet-overlay"></div>
<div class="check-subscription-overlay"></div>
<div class="subscribe-month-overlay"></div>
<div class="subscribe-year-overlay"></div>
<div class="deposit-overlay"></div>
<div class="add_card-overlay"></div>
<div class="bin_mouth-overlay"></div>
<div class="bin_premium_mouth-overlay"></div>
<div class="bin_years-overlay"></div>
<div class="bin_premium_years-overlay"></div>
{% with lang=user.language|default:"English" %}
    {% if lang == "English"|default:"English" %}

    {% if messages %}
        <div style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
            {% for message in messages %}
                <div style="background: {% if message.tags == 'error' %}#f44336{% else %}#4CAF50{% endif %}; color: white; padding: 15px 20px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); animation: slideIn 0.3s;">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
        <style>
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        </style>
        <script>
            setTimeout(() => {
                document.querySelectorAll('[style*="slideIn"]').forEach(el => {
                    el.style.animation = 'slideOut 0.3s';
                    setTimeout(() => el.remove(), 300);
                });
            }, 5000);
        </script>
    {% endif %}

        <label class="hamburger" for="menu-toggle"><span></span><span></span><span></span></label>
        <label for="menu-toggle" class="overlay"></label>

        <div class="side-menu">
            <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="Avatar">
            <div class="username">{{ user.username }}</div>
            {% if user.subscribe == "Bin+" %}
                <div style="color:#0056b3" class="username-line">{{ user.subscribe }}</div>
            {% elif user.subscribe == "Bin_premium" %}
                <div style="color:#b3009b" class="username-line">{{ user.subscribe }}</div>
            {% endif %}
            <label for="profile-toggle" class="profile-btn">My profile</label>
            <label for="wallet-toggle" class="profile-btn">Wallet</label>
            <label for="setting-toggle" class="profile-btn">Setting</label>
        </div>

        <div class="profile-form">
            <div class="profile-header">
                <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="Avatar">
                <div class="info">
                    <h2 class="username-text">{{ user.username }}</h2>
                    <p class="status" style="color: {% if user.status == 'Online' %}green{% else %}red{% endif %};">
                        {{ user.status|default:"Offline" }}
                    </p>
                    <br>
                    <label style="color:#0056b3" for="form1-toggle" class="cursor-pointer edit-icon">Edit profile</label>  
                </div>
            </div>
            <hr class="profile-divider">
            <div class="profile-body">
                <p><strong>Description:</strong> {{ user.description }}</p>
                <p><strong>Teg:</strong> <span class="tag-copy" id="user-tag">{{ user.your_tag }}</span></p>
                <p><strong>Birthday:</strong> {{ user.birthday|default:"Not specified" }}</p>
            </div>
        </div>      

        <div class="setting-form">
            <h2>Setting</h2>
            <label for="form1-toggle" class="profile-btn">Edit profile</label>
            <label for="form2-toggle" class="profile-btn">Language</label>
            <label for="subscribe-month-toggle" class="profile-btn">Subscribe</label>
            <form id="logout-form" method="post" action="{% url 'logout' %}" style="display: none;">
            {% csrf_token %}
            </form>
            <label class="profile-btn" a href="#" onclick="event.preventDefault(); document.getElementById('logout-form').submit();">
                    Logout
                </a>
            </label>
        </div>

        <div class="form1">
            <h2>Edit profile</h2>
            <form method="POST" enctype="multipart/form-data">{% csrf_token %}
                <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="Avatar">
                <br>
                <label>Select new avatar:
                  <input type="file" id="avatarInput" name="photo" accept="image/*">
                </label>
                <p><strong>Username:</strong></p>
                <input type="text" name="username" value="{{ user.username }}" maxlength="18" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <p><strong>Description:</strong></p>
                <textarea name="description" rows="3" style="resize: none; width: 100%;">{{ user.description }}</textarea>      

                <p><strong>Teg:</strong></p>
                <div style="display:flex; gap:5px; align-items:center;">
                    <input type="text" name="your_tag" value="{{ user.your_tag }}" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                </div>      

                <p><strong>Birthday:</strong></p>
                <div style="display:flex; gap:10px;">
                    <select name="day">{% for d in days %}<option value="{{ d }}" {% if birthday.day == d %}selected{% endif %}>{{ d }}</option>{% endfor %}</select>
                    <select name="month">{% for m in months %}<option value="{{ m }}" {% if birthday.month == m %}selected{% endif %}>{{ m }}</option>{% endfor %}</select>
                    <select name="year">{% for y in years %}<option value="{{ y }}" {% if birthday.year == y %}selected{% endif %}>{{ y }}</option>{% endfor %}</select>
                </div>      

                <button type="submit" style="margin-top:15px; padding:10px 20px; border-radius:8px; border:none; background:teal; color:white;">Save</button>
            </form>
        </div>

        <div class="form2">
            <form class="language-form" method="POST" action="{% url 'change-language' %}">
                {% csrf_token %}
                <select name="language">
                    <option value="English" {% if lang == "English" %}selected{% endif %}>English</option>
                    <option value="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" {% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}selected{% endif %}>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                </select>
                <button type="submit">Change</button>
            </form>
        </div>

        <div class="wallet wallet-form">
            <p id="wallet-amount">Wallet: {{ price_converted }}</p>
            <form action="{% url 'change-currency' %}" method="post">
                {% csrf_token %}
                <select name="currency" onchange="this.form.submit()">
                    <option value="USD" {% if user.currency == 'USD' %}selected{% endif %}>USD $</option>
                    <option value="UAH" {% if user.currency == 'UAH' %}selected{% endif %}>UAH ‚Ç¥</option>
                </select>
            </form>
            <button type="button" class="deposit-btn" onclick="checkCardsAndOpenDeposit()">Deposit to wallet</button>
            <button type="button" class="add_card-btn" onclick="openAdd_card('add_card')">Add card</button>
            <div id="cards-list" style="margin-top:12px;">
                <strong>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ö–∞—Ä—Ç–∫–∏:{% else %}Cards:{% endif %}</strong>
                <div style="margin-top:6px;">
                    {% if cards and cards.count %}
                        {% for c in cards %}
                            <div class="card-item" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">
                                <span>**** **** ****{{ c.last4 }} ‚Äî {{ c.cardholder|default:'-' }} ‚Äî {{ c.expiry_month|stringformat:"02d" }}/{{ c.expiry_year }}</span>
                                <button type="button" onclick="deleteCard('{{ c.last4 }}')" style="background:red; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:12px;">üóëÔ∏è</button>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="card-item" style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ö–∞—Ä—Ç –Ω–µ –¥–æ–¥–∞–Ω–æ{% else %}No cards added{% endif %}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <label for="add_card-toggle" class="add_card-overlay"></label>
        <div class="add_card add_card-form">
            <h2>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–î–æ–¥–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É{% else %}Add card{% endif %}</h2>
            <form id="add-card-form" onsubmit="return false;">
                <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏{% else %}Card number{% endif %}</label>
                <input id="card-number" type="text" inputmode="numeric" pattern="[0-9\s]*" maxlength="19" placeholder="1235 9864 2134 1253" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <label style="margin-top:8px;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–Ü–º'—è –≤–ª–∞—Å–Ω–∏–∫–∞{% else %}Cardholder name{% endif %}</label>
                <input id="card-cardholder" type="text" placeholder="NAME SURNAME" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <div style="display:flex; gap:8px; margin-top:8px;">
                    <div style="flex:1;">
                        <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ú—ñ—Å—è—Ü—å{% else %}Month{% endif %}</label>
                        <select id="card-expiry-month" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                            {% for m in months %}
                                <option value="{{ m }}">{{ m|stringformat:"02d" }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div style="flex:1;">
                        <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–†—ñ–∫{% else %}Year{% endif %}</label>
                        <select id="card-expiry-year" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                            {% for y in expiry_years %}
                                <option value="{{ y }}">{{ y }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <label style="margin-top:8px;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}CVV (–Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è){% else %}CVV (not stored){% endif %}</label>
                <input id="card-cvv" type="password" maxlength="4" placeholder="123" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <div style="display:flex; gap:8px; margin-top:12px;">
                    <button type="button" class="deposit-btn" onclick="submitAddCard()">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–î–æ–¥–∞—Ç–∏{% else %}Add{% endif %}</button>
                    <button type="button" class="deposit-btn" onclick="(function(){ const cb=document.getElementById('add_card-toggle'); if(cb) cb.checked=false; })()">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–í—ñ–¥–º—ñ–Ω–∏—Ç–∏{% else %}Cancel{% endif %}</button>
                </div>
                <p id="add-card-result" style="margin-top:8px;color:#333;font-weight:600;"></p>
            </form>
        </div>

        <label for="deposit-toggle" class="deposit-overlay"></label>
        <div class="deposit deposit-form">
            <h2>Deposit</h2>
            <p>wallet: <span id="deposit-wallet">{{ price_converted }}</span></p>
            <select id="deposit-card" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; margin-bottom:10px;">
                {% if cards and cards.count %}
                    {% for c in cards %}
                        <option value="{{ c.last4 }}">**** **** **** {{ c.last4 }} ‚Äî {{ c.cardholder|default:'-' }}</option>
                    {% endfor %}
                {% endif %}
            </select>
            <input id="deposit-amount" type="number" placeholder="Amount" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
            <p id="deposit-result" style="margin-top:8px;color:#333;font-weight:600;"></p>
            <button type="button" class="deposit-btn" onclick="performDeposit()">Deposit</button>
        </div>

        <div class="subscribe-form-month">
            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ -->
            <div class="subscribe-buttons" style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                <button type="button" class="Subscribe-switching-button" onclick="openSubscribe('month')">Month</button>
                <button type="button" class="Subscribe-switching-button year-btn" onclick="openSubscribe('year')">
                    Year
                    <span class="discount">-17%</span>
                </button>
            </div>

            <div class="plans-container" style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    $4.99 <small>/ m</small>
                                {% elif user.currency == 'UAH' %}
                                    ‚Ç¥209.99 <small>/ m</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin+</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_mouth-toggle" class="button">Choose plan</label>
                        </div>
                    </div>
                </div>      

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    $9.99 <small>/ m</small>
                                {% elif user.currency == 'UAH' %}
                                    ‚Ç¥419.99 <small>/ m</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin premium</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_premium_mouth-toggle" class="button">Choose plan</label>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <label for="check-subscription-toggle" class="check-subscription-btn">Check subscription status</label>
            </div>
        </div>

        <!-- –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä—ñ–∫ -->
        <div class="subscribe-form-year">
            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ -->
            <div class="subscribe-buttons" style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                <button type="button" class="Subscribe-switching-button" onclick="openSubscribe('month')">Month</button>
                <button type="button" class="Subscribe-switching-button year-btn" onclick="openSubscribe('year')">
                    Year
                    <span class="discount">-17%</span>
                </button>
            </div>

            <div class="plans-container" style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    <span class="old-price">$59.88</span>
                                    <span class="new-price">$49.99</span> <small>/ y</small>
                                {% elif user.currency == 'UAH' %}
                                    <span class="old-price">‚Ç¥2519.88</span>
                                    <span class="new-price">‚Ç¥2099.99</span> <small>/ y</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin+</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_years-toggle" class="button">Choose plan</label>
                        </div>
                    </div>
                </div>      

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    <span class="old-price">$119.88</span>
                                    <span class="new-price">$99.99</span> <small>/ y</small>
                                {% elif user.currency == 'UAH' %}
                                    <span class="old-price">‚Ç¥5039.88</span>
                                    <span class="new-price">‚Ç¥4199.99</span> <small>/ y</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin premium</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_premium_years-toggle" class="button">Choose plan</label>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <label for="check-subscription-toggle" class="check-subscription-btn">Check subscription status</label>
            </div>
        </div>
        
        <div class="form3">
        </div>
            <div class="content">
                <h1>Welcome to the main page!</h1>
                <p>Click on the three lines in the top left corner to open the side menu with the form.</p>
            </div>

<div class="check-subscription-form">
    <h2>Your subscription status: {{ user.subscribe }}</h2>

    {% if user.subscription_end %}
        <p>Time left: <span id="countdown"></span></p>
    {% else %}
        <p>Your subscription is Basic</p>
    {% endif %}
</div>

<div class="bin_mouth-form">
    <h2>Update your plan to Bin+</h2>
    <form method="post">
        {% csrf_token %}
        <p>Wallet: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $4.99 <small>/ m</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥209.99 <small>/ m</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-bin">
            <label for="terms-bin">I agree with the <a href="/terms" target="_blank">terms and conditions</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_plus_monthly" id="subscribe-bin" disabled class="subscribe-btn">Subscribe</button>
        <!-- <button type="submit" name="subscription_plan" value="bin_plus_test" id="subscribe-bin" disabled class="subscribe-btn">Subscribe</button> -->
    </form>
</div>

<div class="bin_premium_mouth-form">
    <h2>Update your plan to Bin Premium</h2>
    <form method="post">
        {% csrf_token %}
        <p>Wallet: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $9.99 <small>/ m</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥419.99 <small>/ m</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-premium">
            <label for="terms-premium">I agree with the <a href="/terms" target="_blank">terms and conditions</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_premium_monthly" id="subscribe-premium" disabled class="subscribe-btn">Subscribe</button>
    </form>
</div>

<div class="bin_years-form">
    <h2>Update your plan to Bin+ Yearly</h2>
    <form method="post">
        {% csrf_token %}
        <p>Wallet: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $49.99 <small>/ y</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥2099.99 <small>/ y</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-bin-year">
            <label for="terms-bin-year">I agree with the <a href="/terms" target="_blank">terms and conditions</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_plus_yearly" id="subscribe-bin-year" disabled class="subscribe-btn">Subscribe</button>
    </form>
</div>

<div class="bin_premium_years-form">
    <h2>Update your plan to Bin Premium Yearly</h2>
    <form method="post">
        {% csrf_token %}
        <p>Wallet: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $99.99 <small>/ y</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥4199.99 <small>/ y</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-premium-year">
            <label for="terms-premium-year">I agree with the <a href="/terms" target="_blank">terms and conditions</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_premium_yearly" id="subscribe-premium-year" disabled class="subscribe-btn">Subscribe</button>
    </form>
</div>















        {% elif lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}
        <label class="hamburger" for="menu-toggle"><span></span><span></span><span></span></label>
        <label for="menu-toggle" class="overlay"></label>       

        <div class="side-menu">
            <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="–ê–≤–∞—Ç–∞—Ä">
            <div class="username">{{ user.username }}</div>
            {% if user.subscribe == "Bin+" %}
                <div style="color:#0056b3" class="username-line">{{ user.subscribe }}</div>
            {% elif user.subscribe == "Bin_premium" %}
                <div style="color:#b3009b" class="username-line">{{ user.subscribe }}</div>
            {% endif %}
            <label for="profile-toggle" class="profile-btn">–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å</label>
            <label for="wallet-toggle" class="profile-btn">–ì–∞–º–∞–Ω–µ—Ü—å</label>
            <label for="setting-toggle" class="profile-btn">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</label>
        </div>      

        <div class="profile-form">
            <div class="profile-header">
                <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="–ê–≤–∞—Ç–∞—Ä">
                <div class="info">
                    <h2>{{ user.username }}</h2>
                    <p style="color: {% if user.status == 'Online' %}green{% else %}red{% endif %};">
                        {{ user.status|default:"–û—Ñ—Ñ–ª–∞–π–Ω" }}
                    </p>
                    <br>
                    <label style="color:#0056b3" for="form1-toggle" class="cursor-pointer edit-icon">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</label>  
                </div>
            </div>
            <hr class="profile-divider">
            <div class="profile-body">
                <p><strong>–û–ø–∏—Å:</strong> {{ user.description }}</p>
                <p><strong>–¢–µ–≥:</strong> <span class="tag-copy" id="user-tag">{{ user.your_tag }}</span></p>
                <p><strong>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</strong> {{ user.birthday|default:"–ù–µ –≤–∫–∞–∑–∞–Ω–æ" }}</p>
            </div>
        </div>      

        <div class="setting-form">
            <h2>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h2>
            <label for="form1-toggle" class="profile-btn">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</label>
            <label for="form2-toggle" class="profile-btn">–ú–æ–≤–∞</label>
            <label for="subscribe-month-toggle" class="profile-btn">–ü—ñ–¥–ø–∏—Å–∫–∏</label>
            {% csrf_token %}
            </form>
            <label class="profile-btn" a href="#" onclick="event.preventDefault(); document.getElementById('logout-form').submit();">
                    –í–∏–π—Ç–∏ –∑ –∞–∫–∞—É–Ω—Ç—É
                </a>
            </label>
        </div>      

        <div class="form1">
            <h2>–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</h2>
            <form method="POST" enctype="multipart/form-data">{% csrf_token %}
                <img class="avatar" src="{% if user.photo %}{{ user.photo.url }}{% else %}{% static 'pictures/login.png' %}{% endif %}" alt="Avatar">
                <br>
                <label>–í–∏–±–µ—Ä—ñ—Ç—å –Ω–æ–≤—É –∞–≤–∞—Ç–∞—Ä–∫—É:
                  <input type="file" id="avatarInput" name="photo" accept="image/*">
                </label>
                <p><strong>–Ü–º'—è:</strong></p>
                <input type="text" name="username" value="{{ user.username }}" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                
                <p><strong>–û–ø–∏—Å:</strong></p>
                <textarea name="description" rows="3" style="resize: none; width: 100%;">{{ user.description }}</textarea>      

                <p><strong>–¢–µ–≥:</strong></p>
                <div style="display:flex; gap:5px; align-items:center;">
                    <input type="text" name="your_tag" value="{{ user.your_tag }}" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                </div>      

                <p><strong>–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è:</strong></p>
                <div style="display:flex; gap:10px;">
                    <select name="day">{% for d in days %}<option value="{{ d }}" {% if birthday.day == d %}selected{% endif %}>{{ d }}</option>{% endfor %}</select>
                    <select name="month">{% for m in months %}<option value="{{ m }}" {% if birthday.month == m %}selected{% endif %}>{{ m }}</option>{% endfor %}</select>
                    <select name="year">{% for y in years %}<option value="{{ y }}" {% if birthday.year == y %}selected{% endif %}>{{ y }}</option>{% endfor %}</select>
                </div>      

                <button type="submit" style="margin-top:15px; padding:10px 20px; border-radius:8px; border:none; background:teal; color:white;">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            </form>
        </div>      

        <div class="form2">
            <form class="language-form" method="POST" action="{% url 'change-language' %}">
              {% csrf_token %}
              <select name="language">
                <option value="English" {% if lang == "English" %}selected{% endif %}>English</option>
                <option value="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" {% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}selected{% endif %}>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
              </select>
              <button type="submit">{% if lang == "English" %}Change{% else %}–ó–º—ñ–Ω–∏—Ç–∏{% endif %}</button>
            </form>
        </div>  
        
        <div class="wallet wallet-form">
            <p id="wallet-amount">–ì–∞–º–∞–Ω–µ—Ü—å: {{ price_converted }}</p>
            <form action="{% url 'change-currency' %}" method="post">
                {% csrf_token %}
                <select name="currency" onchange="this.form.submit()">
                    <option value="USD" {% if user.currency == 'USD' %}selected{% endif %}>USD $</option>
                    <option value="UAH" {% if user.currency == 'UAH' %}selected{% endif %}>UAH ‚Ç¥</option>
                </select>
            </form>
            <button type="button" class="deposit-btn" onclick="checkCardsAndOpenDeposit()">–ü–æ–ø–æ–≤–Ω–∏—Ç–∏ –≥–∞–º–∞–Ω–µ—Ü—å</button>
            <button type="button" class="add_card-btn" onclick="openAdd_card('add_card')">–î–æ–¥–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É</button>
            <div id="cards-list" style="margin-top:12px;">
                <strong>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ö–∞—Ä—Ç–∫–∏:{% else %}Cards:{% endif %}</strong>
                <div style="margin-top:6px;">
                    {% if cards and cards.count %}
                        {% for c in cards %}
                            <div class="card-item" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">
                                <span>**** **** ****{{ c.last4 }} ‚Äî {{ c.cardholder|default:'-' }} ‚Äî {{ c.expiry_month|stringformat:"02d" }}/{{ c.expiry_year }}</span>
                                <button type="button" onclick="deleteCard('{{ c.last4 }}')" style="background:red; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:12px;">üóëÔ∏è</button>
                            </div>
                        {% endfor %}
                    {% else %}
                        <div class="card-item" style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ö–∞—Ä—Ç –Ω–µ –¥–æ–¥–∞–Ω–æ{% else %}No cards added{% endif %}</div>
                    {% endif %}
                </div>
            </div>
        </div>

        <label for="add_card-toggle" class="add_card-overlay"></label>
        <div class="add_card add_card-form">
            <h2>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–î–æ–¥–∞—Ç–∏ –∫–∞—Ä—Ç–∫—É{% else %}Add card{% endif %}</h2>
            <form id="add-card-form" onsubmit="return false;">
                <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ù–æ–º–µ—Ä –∫–∞—Ä—Ç–∫–∏{% else %}Card number{% endif %}</label>
                <input id="card-number" type="text" inputmode="numeric" pattern="[0-9\s]*" maxlength="19" placeholder="1235 9864 2134 1253" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <label style="margin-top:8px;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–Ü–º'—è –≤–ª–∞—Å–Ω–∏–∫–∞{% else %}Cardholder name{% endif %}</label>
                <input id="card-cardholder" type="text" placeholder="NAME SURNAME" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <div style="display:flex; gap:8px; margin-top:8px;">
                    <div style="flex:1;">
                        <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ú—ñ—Å—è—Ü—å{% else %}Month{% endif %}</label>
                        <select id="card-expiry-month" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                            {% for m in months %}
                                <option value="{{ m }}">{{ m|stringformat:"02d" }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div style="flex:1;">
                        <label>{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–†—ñ–∫{% else %}Year{% endif %}</label>
                        <select id="card-expiry-year" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
                            {% for y in expiry_years %}
                                <option value="{{ y }}">{{ y }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <label style="margin-top:8px;">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}CVV (–Ω–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è){% else %}CVV (not stored){% endif %}</label>
                <input id="card-cvv" type="password" maxlength="4" placeholder="123" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">

                <div style="display:flex; gap:8px; margin-top:12px;">
                    <button type="button" class="deposit-btn" onclick="submitAddCard()">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–î–æ–¥–∞—Ç–∏{% else %}Add{% endif %}</button>
                    <button type="button" class="deposit-btn" onclick="(function(){ const cb=document.getElementById('add_card-toggle'); if(cb) cb.checked=false; })()">{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–í—ñ–¥–º—ñ–Ω–∏—Ç–∏{% else %}Cancel{% endif %}</button>
                </div>
                <p id="add-card-result" style="margin-top:8px;color:#333;font-weight:600;"></p>
            </form>
        </div>

        <label for="deposit-toggle" class="deposit-overlay"></label>
        <div class="deposit deposit-form">
            <h2>Deposit</h2>
            <p>wallet: <span id="deposit-wallet">{{ price_converted }}</span></p>
            <select id="deposit-card" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc; margin-bottom:10px;">
                {% if cards and cards.count %}
                    {% for c in cards %}
                        <option value="{{ c.last4 }}">**** **** **** {{ c.last4 }} ‚Äî {{ c.cardholder|default:'-' }}</option>
                    {% endfor %}
                {% endif %}
            </select>
            <input id="deposit-amount" type="number" placeholder="Amount" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
            <p id="deposit-result" style="margin-top:8px;color:#333;font-weight:600;"></p>
            <button type="button" class="deposit-btn" onclick="performDeposit()">Deposit</button>
        </div>

        <div class="deposit deposit-form">
            <h2>–ü–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –≥—Ä–æ—à–µ–π</h2>
            <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span id="deposit-wallet">{{ price_converted }}</span></p>
            <input id="deposit-amount" type="number" placeholder="Amount" style="width:100%; padding:8px; border-radius:6px; border:1px solid #ccc;">
            <p id="deposit-result" style="margin-top:8px;color:#333;font-weight:600;"></p>
            <button type="button" class="deposit-btn" onclick="performDeposit()">–ü–æ–ø–æ–≤–Ω–∏—Ç–∏</button>
        </div>

        <div class="subscribe-form-month">
            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ -->
            <div class="subscribe-buttons" style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                <button type="button" class="Subscribe-switching-button" onclick="openSubscribe('month')">–ú—ñ—Å—è—Ü—å</button>
                <button type="button" class="Subscribe-switching-button year-btn" onclick="openSubscribe('year')">
                    –†—ñ–∫
                    <span class="discount">-17%</span>
                </button>
            </div>

            <div class="plans-container" style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    $4.99 <small>/ –º</small>
                                {% elif user.currency == 'UAH' %}
                                    ‚Ç¥209.99 <small>/ –º</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin+</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_mouth-toggle" class="button">–í–∏–±—Ä–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É</label>
                        </div>
                    </div>
                </div>      

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    $9.99 <small>/ –º</small>
                                {% elif user.currency == 'UAH' %}
                                    ‚Ç¥419.99 <small>/ –º</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin premium</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_premium_mouth-toggle" class="button">–í–∏–±—Ä–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É</label>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <label for="check-subscription-toggle" class="check-subscription-btn">–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–ø–∏—Å–∫–∏</label>
            </div>
        </div>

        <!-- –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä—ñ–∫ -->
        <div class="subscribe-form-year">
            <!-- –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ -->
            <div class="subscribe-buttons" style="display: flex; justify-content: center; gap: 40px; margin-bottom: 20px;">
                <button type="button" class="Subscribe-switching-button" onclick="openSubscribe('month')">–ú—ñ—Å—è—Ü—å</button>
                <button type="button" class="Subscribe-switching-button year-btn" onclick="openSubscribe('year')">
                    –†—ñ–∫
                    <span class="discount">-17%</span>
                </button>
            </div>

            <div class="plans-container" style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    <span class="old-price">$59.88</span>
                                    <span class="new-price">$49.99</span> <small>/ y</small>
                                {% elif user.currency == 'UAH' %}
                                    <span class="old-price">‚Ç¥2519.88</span>
                                    <span class="new-price">‚Ç¥2099.99</span> <small>/ y</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin+</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_years-toggle" class="button">–í–∏–±—Ä–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É</label>
                        </div>
                    </div>
                </div>      

                <!-- From Uiverse.io by Yaya12085 --> 
                <div class="plan">
                    <div class="inner">
                        <span class="pricing">
                            <span>
                                {% if user.currency == 'USD' %}
                                    <span class="old-price">$119.88</span>
                                    <span class="new-price">$99.99</span> <small>/ y</small>
                                {% elif user.currency == 'UAH' %}
                                    <span class="old-price">‚Ç¥5039.88</span>
                                    <span class="new-price">‚Ç¥4199.99</span> <small>/ y</small>
                                {% endif %}
                            </span>
                        </span>
                        <p class="title">Bin premium</p>
                        <p class="info">This plan is for those who have a team already and running a large business.</p>
                        <ul class="features">
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span><strong>20</strong> team members</span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>Plan <strong>team meetings</strong></span>
                            </li>
                            <li>
                                <span class="icon">
                                    <svg height="24" width="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M0 0h24v24H0z" fill="none"></path>
                                        <path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path>
                                    </svg>
                                </span>
                                <span>File sharing</span>
                            </li>
                        </ul>
                        <div class="action">
                            <label for="bin_premium_years-toggle" class="button">–í–∏–±—Ä–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å–∫—É</label>
                        </div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <label for="check-subscription-toggle" class="check-subscription-btn">–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–ø–∏—Å–∫–∏</label>
            </div>
        </div>

<div class="check-subscription-form">
    <h2>–í–∞—à —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–ø–∏—Å–∫–∏: {{ user.subscribe }}</h2>

    {% if user.subscription_end %}
        <p>–ó–∞–ª–∏—à–∏–ª–æ—Å—å: <span id="countdown"></span></p>
    {% else %}
        <p>–£ –≤–∞—Å –Ω–µ–º–∞—î –ø—ñ–¥–ø–∏—Å–∫–∏</p>
    {% endif %}
</div>

<div class="bin_mouth-form">
    <h2>–û–Ω–æ–≤—ñ—Ç—å —Å–≤—ñ–π –ø–ª–∞–Ω –¥–æ Bin+</h2>
    <form method="post">
        {% csrf_token %}
        <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $4.99 <small>/ –º</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥209.99 <small>/ –º</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-bin">
            <label for="terms-bin">–Ø –∑–≥–æ–¥–µ–Ω –∑ <a href="/terms" target="_blank">—É–º–æ–≤–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_plus_monthly" id="subscribe-bin" disabled class="subscribe-btn">–ü—ñ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
        <!-- <button type="submit" name="subscription_plan" value="bin_plus_test" id="subscribe-bin" disabled class="subscribe-btn">Subscribe</button> -->
    </form>
</div>

<div class="bin_premium_mouth-form">
    <h2>–û–Ω–æ–≤—ñ—Ç—å —Å–≤—ñ–π –ø–ª–∞–Ω –¥–æ Bin Premium</h2>
    <form method="post">
        {% csrf_token %}
        <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $9.99 <small>/ –º</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥419.99 <small>/ –º</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-premium">
            <label for="terms-premium">–Ø –∑–≥–æ–¥–µ–Ω –∑ <a href="/terms" target="_blank">—É–º–æ–≤–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_premium_monthly" id="subscribe-premium" disabled class="subscribe-btn">–ü—ñ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
    </form>
</div>

<div class="bin_years-form">
    <h2>–û–Ω–æ–≤—ñ—Ç—å —Å–≤—ñ–π –ø–ª–∞–Ω –¥–æ Bin+ Yearly</h2>
    <form method="post">
        {% csrf_token %}
        <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $49.99 <small>/ —Ä</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥2099.99 <small>/ —Ä</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-bin-year">
            <label for="terms-bin-year">–Ø –∑–≥–æ–¥–µ–Ω –∑ <a href="/terms" target="_blank">—É–º–æ–≤–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_plus_yearly" id="subscribe-bin-year" disabled class="subscribe-btn">–ü—ñ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
    </form>
</div>

<div class="bin_premium_years-form">
    <h2>–û–Ω–æ–≤—ñ—Ç—å —Å–≤—ñ–π –ø–ª–∞–Ω –¥–æ Premium Yearly</h2>
    <form method="post">
        {% csrf_token %}
        <p>–ì–∞–º–∞–Ω–µ—Ü—å: <span>{{ price_converted }}</span></p>
        {% if user.currency == 'USD' %}
            $99.99 <small>/ —Ä</small>
        {% elif user.currency == 'UAH' %}
            ‚Ç¥4199.99 <small>/ —Ä</small>
        {% endif %}
        <div>
            <input type="checkbox" id="terms-premium-year">
            <label for="terms-premium-year">–Ø –∑–≥–æ–¥–µ–Ω –∑ <a href="/terms" target="_blank">—É–º–æ–≤–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è</a></label>
        </div>
        <button type="submit" name="subscription_plan" value="bin_premium_yearly" id="subscribe-premium-year" disabled class="subscribe-btn">–ü—ñ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
    </form>
</div>

        <div class="content">
            <h1>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –Ω–∞ –≥–æ–ª–æ–≤–Ω—É —Å—Ç–æ—Ä—ñ–Ω–∫—É!</h1>
            <p>–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —Ç—Ä–∏ –ª—ñ–Ω—ñ—ó —É –≤–µ—Ä—Ö–Ω—å–æ–º—É –ª—ñ–≤–æ–º—É –∫—É—Ç—ñ, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ –±—ñ—á–Ω–µ –º–µ–Ω—é –∑ —Ñ–æ—Ä–º–æ—é.</p>
        </div>
        {% endif %}
{% endwith %}

<script>
{% if user.subscription_end %}
    // –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
    const endDate = new Date("{{ user.subscription_end|date:'Y-m-d H:i:s' }}").getTime();
    const countdownEl = document.getElementById('countdown');

    function updateCountdown() {
        const now = new Date().getTime();
        const distance = endDate - now;

        if (distance < 0) {
            countdownEl.innerHTML = "Expired";
            location.reload(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –ø–æ–¥–ø–∏—Å–∫–∞ —Å—Ç–∞–ª–∞ Basic
            return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);

        countdownEl.innerHTML = `${days}d ${hours}h ${minutes}m ${seconds}s`;
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
{% endif %}

// –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
window.deleteCard = function(last4) {
    const lang = "{{ user.language|default:'English' }}";
    const confirmMsg = lang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' 
        ? `–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫–∞—Ä—Ç–∫—É ****${last4}?`
        : `Are you sure you want to delete card ****${last4}?`;
    
    if (!confirm(confirmMsg)) return;

    const csrfInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
    const csrf = csrfInput ? csrfInput.value : '';

    fetch('/delete-card/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': csrf,
        },
        body: JSON.stringify({ last4: last4 })
    })
    .then(r => r.json())
    .then(data => {
        if (data.error) {
            alert(data.error);
            return;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç
        const cardsList = document.getElementById('cards-list');
        const cardMessages = {
            cards_label: lang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' ? '–ö–∞—Ä—Ç–∫–∏:' : 'Cards:',
            no_cards: lang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' ? '–ö–∞—Ä—Ç –Ω–µ –¥–æ–¥–∞–Ω–æ' : 'No cards added',
        };
        
        if (cardsList && data.cards !== undefined) {
            let html = `<strong>${cardMessages.cards_label}</strong><div style="margin-top:6px;">`;
            if (data.cards.length === 0) {
                html += `<div class="card-item" style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">${cardMessages.no_cards}</div>`;
            } else {
                data.cards.forEach(c => {
                    html += `<div class="card-item" style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">
                        <span>**** **** ****${c.last4} ‚Äî ${c.cardholder || '-'} ‚Äî ${c.expiry}</span>
                        <button type="button" onclick="deleteCard('${c.last4}')" style="background:red; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; font-size:12px;">üóëÔ∏è</button>
                    </div>`;
                });
            }
            html += '</div>';
            cardsList.innerHTML = html;
        }
        
        const successMsg = lang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' ? '–ö–∞—Ä—Ç–∫—É –≤–∏–¥–∞–ª–µ–Ω–æ!' : 'Card deleted!';
        alert(successMsg);
    })
    .catch(err => {
        console.error('Delete card failed', err);
        const errorMsg = lang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' ? '–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∫–∞—Ä—Ç–∫–∏' : 'Error deleting card';
        alert(errorMsg);
    });
};

function checkCardsAndOpenDeposit() {
    const cardsList = document.getElementById('cards-list');
    const noCardsMessage = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ö–∞—Ä—Ç –Ω–µ –¥–æ–¥–∞–Ω–æ{% else %}No cards added{% endif %}';
    
    if (cardsList.textContent.includes(noCardsMessage)) {
        // No cards - redirect to add card form
        openAdd_card('add_card');
        document.getElementById('add-card-result').textContent = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–°–ø–æ—á–∞—Ç–∫—É –¥–æ–¥–∞–π—Ç–µ –∫–∞—Ä—Ç–∫—É{% else %}Please add a card first{% endif %}';
    } else {
        // Has cards - open deposit form
        openSubscribe('deposit');
    }
}
function performDeposit() {
    const amount = document.getElementById('deposit-amount').value;
    const cardSelect = document.getElementById('deposit-card');
    
    if (!cardSelect || !cardSelect.value) {
        document.getElementById('deposit-result').textContent = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ë—É–¥—å –ª–∞—Å–∫–∞, –¥–æ–¥–∞–π—Ç–µ –∫–∞—Ä—Ç–∫—É{% else %}Please add a card first{% endif %}';
        return;
    }
    
    if (!amount || isNaN(amount) || amount <= 0) {
        document.getElementById('deposit-result').textContent = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É —Å—É–º—É{% else %}Please enter a valid amount{% endif %}';
        return;
    }
    fetch('/deposit-funds/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            amount: amount,
            card_last4: cardSelect.value
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            document.getElementById('wallet-amount').textContent = `{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ì–∞–º–∞–Ω–µ—Ü—å{% else %}Wallet{% endif %}: ${data.new_balance}`;
            document.getElementById('deposit-wallet').textContent = data.new_balance;
            document.getElementById('deposit-amount').value = '';
            document.getElementById('deposit-result').textContent = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–£—Å–ø—ñ—à–Ω–æ –ø–æ–ø–æ–≤–Ω–µ–Ω–æ!{% else %}Successfully deposited!{% endif %}';
        } else {
            document.getElementById('deposit-result').textContent = data.error || '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—ñ{% else %}Error depositing funds{% endif %}';
        }
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('deposit-result').textContent = '{% if lang == "–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" %}–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –ø–æ–ø–æ–≤–Ω–µ–Ω–Ω—ñ{% else %}Error depositing funds{% endif %}';
    });
}


document.addEventListener('DOMContentLoaded', () => {
    // localized card messages (from view)
    const cardMessages = {
        invalid_card_number: "{{ card_messages.invalid_card_number }}",
        card_added: "{{ card_messages.card_added }}",
        add_card_failed: "{{ card_messages.add_card_failed }}",
        cards_label: "{{ card_messages.cards_label }}",
        no_cards: "{{ card_messages.no_cards }}",
    };
    const tagElement = document.getElementById('user-tag');
    if (tagElement) {
        tagElement.addEventListener('click', () => {
            const text = tagElement.textContent;
            navigator.clipboard.writeText(text)
                .then(() => alert('Tag copied!'))
                .catch(err => console.error('Error copying tag:', err));
        });
    }

    // Close forms when clicking outside
    document.addEventListener('mousedown', (event) => {
        const forms = [
            { form: '.side-menu', toggle: '#menu-toggle' },
            { form: '.wallet-form', toggle: '#wallet-toggle' },
            { form: '.profile-form', toggle: '#profile-toggle' },
            { form: '.setting-form', toggle: '#setting-toggle' },
            { form: '.form1', toggle: '#form1-toggle' },
            { form: '.form2', toggle: '#form2-toggle' },
            { form: '.deposit-form', toggle: '#deposit-toggle' },
            { form: '.add_card-form', toggle: '#add_card-toggle' }
        ];

        forms.forEach(({form, toggle}) => {
            const formElement = document.querySelector(form);
            const toggleElement = document.querySelector(toggle);
            
            if (formElement && toggleElement && toggleElement.checked) {
                if (!formElement.contains(event.target) && !event.target.closest(form)) {
                    toggleElement.checked = false;
                }
            }
        });
    });

    const overlays = document.querySelectorAll('.overlay, .profile-overlay, .setting-overlay, .form1-overlay, .form2-overlay, .wallet-overlay, .check-subscription-overlay, .subscribe-month-overlay, .subscribe-year-overlay, .bin_mouth-overlay, .bin_premium_mouth-overlay, .bin_years-overlay, .bin_premium_years-overlay, .deposit-overlay, .add_card-overlay');
    overlays.forEach(overlay => {
        overlay.addEventListener('click', () => {
            const checkboxes = document.querySelectorAll('#menu-toggle, #profile-toggle, #setting-toggle, #form1-toggle, #form2-toggle, #wallet-toggle, #check-subscription-toggle ,#subscribe-month-toggle, #subscribe-year-toggle, #bin_mouth-toggle, #bin_premium_mouth-toggle, #bin_years-toggle, #bin_premium_years-toggle, #deposit-toggle, #add_card-toggle');
            checkboxes.forEach(cb => {
                if(cb) cb.checked = false;
            });
        });
    });

    const depositInput = document.getElementById('deposit-amount');
    const depositResult = document.getElementById('deposit-result');
    const depositWalletSpan = document.getElementById('deposit-wallet');
    const currencySelect = document.querySelector('.wallet form select');

    function parseAmountAndCurrency(text) {
        if (!text) return { amount: 0, currency: ("{{ user.currency|default:'USD' }}") };
        const t = text.replace(/,/g, '').trim();
        const uah = t.indexOf('‚Ç¥') !== -1 || /UAH/i.test(t);
        const usd = t.indexOf('$') !== -1 || /USD/i.test(t);
        const m = t.match(/([-+]?\d*\.?\d+)/);
        const amount = m ? Number(m[0]) : 0;
        const currency = uah ? 'UAH' : (usd ? 'USD' : ("{{ user.currency|default:'USD' }}"));
        return { amount, currency };
    }

    function formatCurrency(amount, currency) {
        if (amount === null || amount === undefined) return '';
        const a = Number(amount) || 0;
        if (currency === 'UAH') return a.toFixed(2) + ' ‚Ç¥';
        return a.toFixed(2) + ' $';
    }

    function convertAmount(value, sourceCurrency, targetCurrency) {
        const v = Number(value) || 0;
        if (sourceCurrency === targetCurrency) return v;
        if (sourceCurrency === 'USD' && targetCurrency === 'UAH') return v * 42.1;
        if (sourceCurrency === 'UAH' && targetCurrency === 'USD') return v / 42.1;
        return v;
    }

    function updateDepositResult() {
        if (!depositInput || !depositResult || !depositWalletSpan) return;

        const walletRaw = depositWalletSpan.textContent || depositWalletSpan.innerText || '';
        const wallet = parseAmountAndCurrency(walletRaw);

        const depositVal = Number(depositInput.value) || 0;
        const depositCurrency = (currencySelect && currencySelect.value) ? currencySelect.value : ("{{ user.currency|default:'USD' }}");

    const depositConverted = convertAmount(depositVal, depositCurrency, wallet.currency);
    const total = (Number(wallet.amount) || 0) + depositConverted;

    const pageLang = "{{ user.language|default:'English' }}";
    const willBeText = pageLang === '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞' ? '–ë—É–¥–µ' : 'Will be';
    depositResult.textContent = depositVal ? `${willBeText}: ${formatCurrency(total, wallet.currency)}` : '';
    }

    // Card number auto-format: add space every 4 digits and preserve caret
    function formatCardNumber(val) {
        // limit to 16 digits (typical card length). Format as '#### #### #### ####'
        const digits = val.replace(/\D/g, '').slice(0, 16);
        return digits.replace(/(.{4})/g, '$1 ').trim();
    }

    const cardNumberInput = document.getElementById('card-number');
    if (cardNumberInput) {
        // format on input and on paste
        cardNumberInput.addEventListener('input', (e) => {
            const el = e.target;
            const selectionStart = el.selectionStart || 0;
            // count digits before cursor
            const rawBefore = el.value.slice(0, selectionStart).replace(/\D/g, '');
            const formatted = formatCardNumber(el.value);
            el.value = formatted;
            // set caret after same number of digits
            let pos = 0;
            let digitsSeen = 0;
            while (digitsSeen < rawBefore.length && pos < el.value.length) {
                if (/\d/.test(el.value.charAt(pos))) digitsSeen++;
                pos++;
            }
            el.setSelectionRange(pos, pos);
        });
        cardNumberInput.addEventListener('paste', (e) => {
            e.preventDefault();
            const paste = (e.clipboardData || window.clipboardData).getData('text') || '';
            const digits = paste.replace(/\D/g, '').slice(0, 16);
            cardNumberInput.value = formatCardNumber(digits);
        });
    }

    if (depositInput) {
        depositInput.addEventListener('input', updateDepositResult);
    }
    if (currencySelect) {
        currencySelect.addEventListener('change', updateDepositResult);
    }

    window.performDeposit = function() {
        if (!depositInput || !depositWalletSpan) return;
        const v = Number(depositInput.value) || 0;
        if (v <= 0) {
            alert('Please enter an amount greater than 0');
            return;
        }

        const depositCurrency = (currencySelect && currencySelect.value) ? currencySelect.value : ("{{ user.currency|default:'USD' }}");

        const csrfInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
        const csrf = csrfInput ? csrfInput.value : '';

        const formData = new FormData();
        formData.append('amount', v);
        formData.append('currency', depositCurrency);

        fetch('{% url "deposit-funds" %}', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrf,
            },
            body: formData,
        })
        .then(resp => {
            if (!resp.ok) throw new Error('Network response was not ok');
            return resp.json();
        })
        .then(data => {
            if (data && data.price_converted) {
                depositWalletSpan.textContent = data.price_converted;
                const walletAmountEl = document.getElementById('wallet-amount');
                if (walletAmountEl) walletAmountEl.textContent = 'Wallet: ' + data.price_converted;
                const depositToggle = document.getElementById('deposit-toggle');
                const walletToggle = document.getElementById('wallet-toggle');
                if (depositToggle) depositToggle.checked = false;
                if (walletToggle) walletToggle.checked = true;
                depositInput.value = '';
                if (depositResult) depositResult.textContent = '';
            } else if (data && data.error) {
                alert('Deposit failed: ' + data.error);
            }
        })
        .catch(err => {
            console.error('Deposit failed:', err);
            alert('Deposit failed');
        });
    };

    window.openSubscribe = function(period) {
        const monthToggle = document.getElementById('subscribe-month-toggle');
        const yearToggle = document.getElementById('subscribe-year-toggle');

            if (period === 'month') {
                if (monthToggle) monthToggle.checked = true;
                if (yearToggle) yearToggle.checked = false;
                const depositToggle = document.getElementById('deposit-toggle');
                if (depositToggle) depositToggle.checked = false;
            } else if (period === 'year') {
                if (yearToggle) yearToggle.checked = true;
                if (monthToggle) monthToggle.checked = false;
                const depositToggle = document.getElementById('deposit-toggle');
                if (depositToggle) depositToggle.checked = false;
            } else if (period === 'deposit') {
                const depositToggle = document.getElementById('deposit-toggle');
                if (depositToggle) depositToggle.checked = true;
                if (monthToggle) monthToggle.checked = false;
                if (yearToggle) yearToggle.checked = false;
            }
    };

    // Open add-card popup
    window.openAdd_card = function() {
        const addToggle = document.getElementById('add_card-toggle');
        if (addToggle) addToggle.checked = true;
        // close other popups
        const monthToggle = document.getElementById('subscribe-month-toggle');
        const yearToggle = document.getElementById('subscribe-year-toggle');
        if (monthToggle) monthToggle.checked = false;
        if (yearToggle) yearToggle.checked = false;
        const depositToggle = document.getElementById('deposit-toggle');
        if (depositToggle) depositToggle.checked = false;
    };

    // Submit add card via AJAX
    window.submitAddCard = function() {
        const numberEl = document.getElementById('card-number');
        const holderEl = document.getElementById('card-cardholder');
        const monthEl = document.getElementById('card-expiry-month');
        const yearEl = document.getElementById('card-expiry-year');
        const resultEl = document.getElementById('add-card-result');

        if (!numberEl || !monthEl || !yearEl) return;
        const number = (numberEl.value || '').replace(/\s+/g, '');
        const holder = holderEl ? holderEl.value : '';
        const month = monthEl.value;
        const year = yearEl.value;

        // enforce 13..16 digits allowed (max 16 digits). Client-side limit reduces chance of extra-digit input.
        if (number.length < 13 || number.length > 16 || !/^[0-9]+$/.test(number)) {
            if (resultEl) resultEl.textContent = cardMessages.invalid_card_number;
            return;
        }

        const csrfInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
        const csrf = csrfInput ? csrfInput.value : '';

        const fd = new FormData();
        fd.append('card_number', number);
        fd.append('cardholder', holder);
        fd.append('expiry_month', month);
        fd.append('expiry_year', year);

        fetch('{% url "add-card" %}', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': csrf,
            },
            body: fd,
        })
        .then(r => r.json())
        .then(data => {
            if (data.error) {
                if (resultEl) resultEl.textContent = data.error;
                return;
            }
            // rebuild cards list
            const cardsList = document.getElementById('cards-list');
            if (cardsList && data.cards) {
                let html = '<strong>' + cardMessages.cards_label + '</strong><div style="margin-top:6px;">';
                if (data.cards.length === 0) html += '<div class="card-item">' + cardMessages.no_cards + '</div>';
                data.cards.forEach(c => {
                    html += `<div class="card-item" style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px solid #eee;">**** **** ****${c.last4} ‚Äî ${c.cardholder || '-'} ‚Äî ${c.expiry}</div>`;
                });
                html += '</div>';
                cardsList.innerHTML = html;
            }
            // close add card form
            const addToggle = document.getElementById('add_card-toggle');
            if (addToggle) addToggle.checked = false;
            if (resultEl) resultEl.textContent = cardMessages.card_added;
            // clear inputs
            if (numberEl) numberEl.value = '';
            if (holderEl) holderEl.value = '';
        })
        .catch(err => {
            console.error('Add card failed', err);
            if (resultEl) resultEl.textContent = cardMessages.add_card_failed;
        });
    };

    const sideMenuLinks = document.querySelectorAll('.side-menu label, .side-menu a');
    sideMenuLinks.forEach(link => {
        link.addEventListener('click', () => {
            const menuToggle = document.getElementById('menu-toggle');
            if(menuToggle) menuToggle.checked = false;
        });
    });

    const formCheckboxes = ['profile-toggle', 'setting-toggle', 'form1-toggle', 'form2-toggle', 'check-subscription-toggle', 'subscribe-month-toggle', 'subscribe-year-toggle', 'bin_mouth-toggle', 'bin_premium_mouth-toggle', 'bin_years-toggle', 'bin_premium_years-toggle', 'deposit-toggle', 'add_card-toggle'];
    formCheckboxes.forEach(id => {
        const cb = document.getElementById(id);
        if(cb) {
            cb.addEventListener('change', () => {
                if(cb.checked) {
                    formCheckboxes.forEach(otherId => {
                        if(otherId !== id) {
                            const otherCb = document.getElementById(otherId);
                            if(otherCb) otherCb.checked = false;
                        }
                    });
                }
            });
        }
    });

    const walletForm = document.querySelector('.wallet form');
    if (walletForm) {
        walletForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(walletForm);
            const csrf = formData.get('csrfmiddlewaretoken');

            fetch(walletForm.action, {
                method: 'POST',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRFToken': csrf,
                },
                body: formData,
            })
            .then(resp => {
                if (!resp.ok) throw new Error('Network response was not ok');
                return resp.json();
            })
            .then(data => {
                if (data && data.price_converted) {
                    const el = document.getElementById('wallet-amount');
                    if (el) el.textContent = 'Wallet: ' + data.price_converted;
                    const depositWallet = document.getElementById('deposit-wallet');
                    if (depositWallet) depositWallet.textContent = data.price_converted;
                    updateDepositResult();
                }
            })
            .catch(err => console.error('Currency change failed:', err));
        });
    }
});

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function setupSubscription(checkboxId, buttonId) {
    const checkbox = document.getElementById(checkboxId);
    const button = document.getElementById(buttonId);

    button.disabled = true;

    checkbox.addEventListener('change', () => {
        button.disabled = !checkbox.checked;
    });
}

setupSubscription('terms-bin', 'subscribe-bin');
setupSubscription('terms-premium', 'subscribe-premium');
setupSubscription('terms-bin-year', 'subscribe-bin-year');
setupSubscription('terms-premium-year', 'subscribe-premium-year');
</script>

{% endblock %}